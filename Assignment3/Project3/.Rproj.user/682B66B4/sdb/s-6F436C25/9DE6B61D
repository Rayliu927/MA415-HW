{
    "collab_server" : "",
    "contents" : "---\ntitle: \"MA415/615 Project One: U.S. Total Illegal Alien Apprehensions Analysis\"\nauthor: \"Xi Cheng, Ziran Min, Shih-Ching Huang\"\ndate: \"February 18, 2018\"\noutput: pdf_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n## Background\nBased on CNN news, we realized that the US-Mexico broader apprehensions hit 17 years lowest in the first few months of the Trump administration. This phenomenon was interpreted as \"President Donald Trump's rhetoric and aggressive push to enforce immigration laws\". Therefore, we want to analyze the data from the past to see whether this phenomenon had already existed before or it's really related to the new law as people saying.\n\n## Data Visualization\nFirst, we can visualize the data we have already got in the file as below.\nTo compare the apprehensions by sectors, we first summed the apprehensions of each sector through 12 months and built the following plot:\n\n```{r, echo=FALSE}\nB2010 <- read.csv(\"/Users/mac/Desktop/MA415/assignment3/bp appre 2010.csv\")\nB2017 <- read.csv(\"/Users/MZR/Desktop/MA 415 Project/PB Apprehensions 2017.csv\")\n#add setor sums and smonth sums in 2010\nrownames(B2010) <- B2010[,1]\nB2010 <- subset(B2010, select = -c(Sector))\n#rearrange the columns by moving Oct, Nov, and Dec to the end \nB2010 <- cbind(subset.data.frame(B2010)[,4:12],subset.data.frame(B2010)[,1:3])\nmonthSum2010 <- colSums((B2010))\nB2010 <- rbind(B2010,monthSum2010)\nrownames(B2010)[10] <- \"Sector Total\"\n\nsectorSum2010 <- rowSums(B2010)\nB2010 <- cbind(B2010,sectorSum2010)\ncolnames(B2010)[13] <- \"Annual Total\" \n\n#add setor sums and smonth sums in 2017\nrownames(B2017) <- B2017[,1]\nB2017 <- subset(B2017, select = -c(Sector))\n#rearrange the columns by moving Oct, Nov, and Dec to the end \nB2017 <- cbind(subset.data.frame(B2017)[,4:12],subset.data.frame(B2017)[,1:3])\nmonthSum2017 <- colSums((B2017))\nB2017 <- rbind(B2017,monthSum2017)\nrownames(B2017)[10] <- \"Sector Total\"\n\nsectorSum2017 <- rowSums(B2017)\nB2017 <- cbind(B2017,sectorSum2017)\ncolnames(B2017)[13] <- \"Annual Total\" \n\n#compare apprehensions by months\nsector <- rownames(B2010)\nmonth <- colnames(B2010)\n#input is the index of the sector you want to look up\ngraph_months <- function(i){ \n  year_comp <- rbind(B2010[i,1:12],B2017[i,1:12])\n  barplot(as.matrix(year_comp), beside = T, col = c(\"green\", \"yellow\"), bty=\"n\",las=2,\n          main = \"Compare 2010 & 2017 Apprehensions by Months\")\n  legend(\"topright\", \n         c(paste(sector[i] ,\"2010\"),paste(sector[i],\"2017\")), \n         pch=15,  \n         col=c(\"green\",\"yellow\"),  \n         bty=\"n\"\n         )\n}\n#compare apprehensions by sectors\n#input is the month you want to look up\ngraph_sectors <- function(i){\n  B2010<-t(B2010)\n  B2017<-t(B2017)\n  year_comp <- rbind(B2010[i,1:9],B2017[i,1:9])\n  barplot(year_comp, \n          beside = TRUE, \n          col = c(\"blue\", \"orange\"), \n          bty=\"n\",\n          las=2,\n          main = \"Compare 2010 & 2017Apprehensions by Sectors\"\n          )\n  legend(\"topleft\", \n         c(paste(month[i] ,\"2010\"),\n           paste(month[i],\"2017\")),\n         pch=15,  \n         col=c(\"blue\", \"orange\"),  \n         bty=\"n\")\n}\ngraph_sectors(13)\n```\n\nWe found that in 2010, Tucson has the most number of apprehensions, and in 2017 the sector with most apprehensions is Rio Grande Valley. But has there been a change in maximum from 2010 to 2017? We will focus on this question in next section.\n\n\\newpage\n\nTo compare apprehensions by months, we summed the apprehensions of each month through sectors and built the following plot:\n\n```{r,echo = FALSE}\ngraph_months(10)\n```\n\nThen, we found out that in March 2010 has the most apprehensions, followed by April and May, and in 2017, the most apprehensions changed to November, which then followed by October and December. We will also go deeper about whether the mean of the 3-month highest apprehensions changed later.\n\nWe also built shiny website <https://chengxi.shinyapps.io/MA415-615-Project-One-Ziran-Xi-ShihChing/> to demonstrate more detailed plots to compare apprehensions across different sectors and months.\n\n\n## Using t-test to Solve Previous Questions \n\nTo find and compare the sector with the most apprehensions in 2010 and with the sector with the most apprehensions in 2017. We ran the following code:\n```{r}\n#find the index of the sector that has most apprehensions in 2010 \nmost_apprehensions_2010 <- match(max(B2010[1:9,13]), B2010[1:9,13])\n#it is Tucson\nrownames(B2010)[most_apprehensions_2010]\n\n#find the index of the sector that has most apprehensions in 2017\nmost_apprehensions_2017 <- match(max(B2017[1:9,13]), B2017[1:9,13])\nmatch(max(B2017[1:9,13]), B2017[1:9,13])\n#it is Rio Grande Valley\nrownames(B2017)[most_apprehensions_2017]\n```\nAfter that, we ensured the most apprehensions in 2010 & 2017 is Tucson and Rio Grande Valley. To whether they have the mean, we conduct the following hypothesis test:\n\n$$H_{0}:\\mu _{Tucson, 2010} - \\mu _{RGV, 2017} = 0$$\n$$H_{a}:\\mu _{Tucson, 2010} - \\mu _{RGV, 2017} \\neq  0$$\n\n```{r,echo=FALSE}\n#create the dataset for Tucson in 2010\nB2010_Tuson <- B2010[most_apprehensions_2010,1:12]\n#create the dataset for Rio Grande Valley in 2017\nB2017_RGV <- B2017[most_apprehensions_2017,1:12]\n\n#test whether these two sample have same sample mean \nt.test(B2010_Tuson, B2017_RGV)\n```\nThrough this Welch Two Sample t-test, we get p-value = 0.06346 > 0.05, so we fail to reject the null hypothesis that the mean of apprehension of Tucson in 2010 is equal to the mean of apprehension of Rio Grande Valley in 2017 at significance level of 5%, and therefore conclude that there is no significant difference between the maximum of apprehensions by secoter in 2010 and 2017\n\nTo solve the second question we came up with in previous section, whether the mean of the 3-month highest apprehensions changed, we did the similar hypothesis test as the following:\n```{r}\n#find the three months that has the most apprehensions in 2010\nmost_3m_apprehensions_2010 <- order(B2010[10,1:12], decreasing = TRUE)[1:3]\n#they are March, April, and May\ncolnames(B2010)[most_3m_apprehensions_2010]\n\n#find the three months that has the most apprehensions in 2017\nmost_3m_apprehensions_2017 <- order(B2017[10,1:12], decreasing = TRUE)[1:3]\n#they are November, October, and December \ncolnames(B2017)[most_3m_apprehensions_2017]\n```\n  \nNull hypothesis and alternative hypothesis:\n$$H_{0}:\\mu _{3 months, 2010} - \\mu _{3 months, 2017} = 0$$\n$$H_{a}:\\mu _{3 months, 2010} - \\mu _{3 months, 2017} \\neq  0$$\n\n```{r,echo=FALSE}\n#create the dataset for March, April, and May in 2010\nB2010_3m <- B2010[most_3m_apprehensions_2010,1:12]\n#create the dataset for November, October, and December in 2017\nB2017_3m <- B2017[most_3m_apprehensions_2017,1:12]\n\n#test whether these two sample have same sample mean \nt.test(B2010_3m, B2017_3m)\n```\nThen we get p-value = 0.3454 > 0.05, so we fail to reject the null hypothesis that the mean of apprehension of from March to May in 2010 is equal to  the mean of apprehension from October to December in 2017 at significance level of 5%, and therefore conclude that there is no significant difference between the maximum of apprehensions from March to May in 2010 and from October to December in 2017.\n\n\n## Time Series\n```{r,echo=FALSE}\nts1 <- read.csv(\"/Users/MZR/Desktop/MA 415 Project/PB monthly summaries.csv\")\n#delete first column\nts2 <- ts1[2:13]\n#rearrange the columns by moving Oct, Nov, and Dec to the end \nts3 <- cbind(subset.data.frame(ts2)[,4:12],subset.data.frame(ts2)[,1:3])\n#reverse data \nts4 <- ts3[ nrow(ts3):1, ]\n#turn it to vectors \nts5 <- as.vector(t(ts4))\n#create time series \nts6 <- ts(ts5,frequency=12,start=c(2000,1))\n#plot time series\nts.plot(ts6, gpars=list(main =\"Time Series Chart of Apprehensions from 2000 to 2017\",xlab=\"year\", ylab=\"Apprehensions\", col= \"black\", lty=c(1:3)))\n#caculate annual averages\nts_avg <- apply(ts4,1,mean)\n#create annual averages in time series\nts_avg<-ts(ts_avg,start = c(2000.5), frequency=1)\n\n#create segments and text for annual averages\n#for (i in 1:18) {\n # segments(1999+i,ts_avg[i],2000+i,ts_avg[i],col = 2,lwd = 1)\n  #text(2000.3 + i, ts_avg[i], labels = 1999+i, cex=0.6, col = \"red\" , font=1)\n#}\n#create points and connected dashed line for better visualization\npoints(ts_avg,col = \"blue\", pch=20)\nlines(ts_avg,col = \"blue\", pch=20,lty=6)\n#create legends\nlegend(2010,220000, legend = c(\"Monthly Apprehensions\",\"Annual Averages by points\",\"Annual Average connected by dashed line\"), \n       col = c(\"black\",\"blue\", \"blue\"),pch =c(NA,20,NA),lty=c(1,NA,3), cex=0.6)\n\n```\n\nAccording to the Time series shown above, we can see that the apprehensions of America keep declining through 2000 to 2017, and reached 17 years lows in 2017.\n\n## Conclusion\nThe decreasing trend and the new lowest level we found from time series chart indeed reflect the effect of President Trump's and the US Department of Homeland Security's strict regulation on illegal apprehensions across the southern border. However, the t-tests we did don't show significant diference between the maximum levels of apprehensions through years. This is acceptable because we didn't compare the mimimum changes through years and our comparisons are across different sectors and months. To further study on the US illegal apprehensions in recently years, we need to conduct more detailed research how the apprehensions in each specific sector changes through months and years.\n\n\n",
    "created" : 1519155436774.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3004283509",
    "id" : "9DE6B61D",
    "lastKnownWriteTime" : 1519285490,
    "last_content_update" : 1519285490887,
    "path" : "~/Desktop/MA415-615-Project-One-Ziran-Xi-ShihChing-master/markdown.Rmd",
    "project_path" : null,
    "properties" : {
        "last_setup_crc32" : "961CB0BAbb338d19",
        "source_window_id" : "wnrwbq5oyx8ms"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}