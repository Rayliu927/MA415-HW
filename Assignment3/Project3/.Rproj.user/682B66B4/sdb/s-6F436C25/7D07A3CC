{
    "collab_server" : "",
    "contents" : "---\ntitle: \"MA415 Project One\"\nauthor: \"Lin Li, Lingjia Zhang, Zirui Liu\"\noutput:\n  html_document: default\n  pdf_document:\n    keep_tex: yes\n    latex_engine: xelatex\n---\n\n## Background\nAccording to the CNN news, apprehensions at the US-Mexico border reached the historic low rate in April 2017, and have a continuing downward trend during the first few months of the Trump administration. The drop of the apprehension rate was interpreted as the sign of “President Donald Trump’s rhetoric and aggressive push to enforce immigration laws is having an effect.” Through this project, we want to analyze by using past data to estimate whether the declining rate of apprehension relates to the President Donald’s new law.\n\n\n# Data Visualization\n\n```{r, echo=FALSE}\nT2010 <- read.csv(\"/Users/mac/Desktop/MA415/assignment3/bp appre 2010.csv\")\nT2017 <- read.csv(\"/Users/mac/Desktop/MA415/assignment3/bp appre 2017.csv\")\n\nrownames(T2010) <- T2010[,1]\nrownames(T2017) <- T2017[,1]\n\n# sum apprehensions of sector and month in 2010\nT2010 <- subset(T2010, select = -c(Sector))\n# sort month in order \nT2010 <- cbind(subset.data.frame(T2010)[,4:12],subset.data.frame(T2010)[,1:3])\nmonthSum2010 <- colSums((T2010))\nT2010 <- rbind(T2010,monthSum2010)\nrownames(T2010)[10] <- \"Sector Total\"\n\nsectorSum2010 <- rowSums(T2010)\nT2010 <- cbind(T2010,sectorSum2010)\ncolnames(T2010)[13] <- \"Month Total\" \n\n# sum apprehensions of sector and month in 2017\nT2017 <- subset(T2017, select = -c(Sector))\n# sort month in order\nT2017 <- cbind(subset.data.frame(T2017)[,4:12],subset.data.frame(T2017)[,1:3])\nmonthSum2017 <- colSums((T2017))\nT2017 <- rbind(T2017,monthSum2017)\nrownames(T2017)[10] <- \"Sector Total\"\n\nsectorSum2017 <- rowSums(T2017)\nT2017 <- cbind(T2017,sectorSum2017)\ncolnames(T2017)[13] <- \"Month Total\" \n\n#compare apprehensions by months\nsector <- rownames(T2010)\nmonth <- colnames(T2010)\n\n#The function takes in the index of the sector as input\nplot_by_months <- function(i){ \n  year <- rbind(T2010[i,1:12],T2017[i,1:12])\n  barplot(as.matrix(year), beside = T, col = c(\"red\", \"yellow\"), bty=\"n\",las=2,\n          main = \"Compare Apprehensions Between 2010&2017 by Months\")\n  legend(\"topright\", \n         c(paste(sector[i] ,\"2010\"),paste(sector[i],\"2017\")), \n         pch=15,  \n         col=c(\"red\",\"yellow\"),  \n         bty=\"n\"\n         )\n}\n\n#The function takes in month as input\nplot_by_sectors <- function(i){\n  T2010<-t(T2010)\n  T2017<-t(T2017)\n  year <- rbind(T2010[i,1:9],T2017[i,1:9])\n  getOption(\"scipen\")\n  opt <- options(\"scipen\" = 20)\n  barplot(year, beside = TRUE, col = c(\"red\", \"yellow\"), bty=\"n\",las=2,\n          main = \"Compare Apprehensions between 2010&2017 by Sectors\"\n          )\n  legend(\"topleft\", \n         c(paste(month[i] ,\"2010\"),\n           paste(month[i],\"2017\")),\n         pch=15,  \n         col=c(\"red\", \"yellow\"),  \n         bty=\"n\")\n}\n```\n\nBased on csv files, we compare the apprehensions by sectors and months between 2010 and 2017. First of all, we sum up apprehensions by sectors and create the following plot.\n```{r}\nplot_by_sectors(13)\n```\n\nSecond of all, we sum up apprehensions by months and create the following plot.\n```{r}\nplot_by_months(10)\n```\n\nBased on these two graphs, it is easy to conclude that in 2010, Tucson has the most apprehensions. In 2017, Rio Grande Valley has the most apprehensions. In 2010, from March to May, there are most apprehensions. In 2017, from October to December, there are most apprehensions.\n\n###### need website!!!!! ####\n\n## Statistic Analysis\n\n# First problem\n\nUse simple statistical tests linke those demonstrated in class to compare the sector with the most apprehensions for 2010 and with the sector with the most apprehensions in 2017. Has there been a change in the maximum?\n```{r}\n#In 2010, the sector that has most apprehensions is Tucson\nmost_2010 <- match(max(T2010[1:9,13]), T2010[1:9,13])\nrownames(T2010)[most_2010]\n\n#In 2017, the sector that has most apprehensions is Rio Grande Valley\nmost_2017 <- match(max(T2017[1:9,13]), T2017[1:9,13])\nrownames(T2017)[most_2017]\n```\nTo evaluate wheter the most apprehensions between 2010(Tucson) and 2017(Rio Grande Valley),we have following null hypothesis and alternative hypothesis:\n\n$$H_{0}:\\mu _{Tucson, 2010} - \\mu _{RGV, 2017} = 0$$\n$$H_{a}:\\mu _{Tucson, 2010} - \\mu _{RGV, 2017} \\neq  0$$\n\n```{r,echo=FALSE}\n# table for Tucson\nT2010_Tuson <- T2010[most_2010,1:12]\n# table for Rio Grande Valley\nT2017_RGV <- T2017[most_2017,1:12]\n\n# test if they have same sample mean \nt.test(T2010_Tuson, T2017_RGV)\n```\nFrom t-test, we get p-value = 0.06346 > 0.05, and we fail to reject the null hypothesis.  At significance level of 5%, the mean of apprehension of Tucson in 2010 is equal to the mean of apprehension of Rio Grande Valley in 2017. Thus, there is no significant difference between the maximum of apprehensions by secoter in 2010 and 2017.\n\n\n# Second problem\n\nFrom the grpah, we know that in 2010, March, April, and May are ranking top 3. In 2017, \nNovember, October, and December are ranking top 3. The statistic analysis we want to \nevaluate is whether the mean of 3-month highest apprehensions has changed.\n```{r}\n# In 2010, March, April,and May have the most apprehensions\ntop3_2010 <- order(T2010[10,1:12], decreasing = TRUE)[1:3]\ncolnames(T2010)[top3_2010]\n\n# In 2017, November, October,and December have the most apprehensions\ntop3_2017 <- order(T2017[10,1:12], decreasing = TRUE)[1:3]\ncolnames(T2017)[top3_2017]\n```\n  \nNull hypothesis and alternative hypothesis:\n$$H_{0}:\\mu _{3 months, 2010} - \\mu _{3 months, 2017} = 0$$\n$$H_{a}:\\mu _{3 months, 2010} - \\mu _{3 months, 2017} \\neq  0$$\n\n```{r,echo=FALSE}\n# table for March, April, and May in 2010\nT2010_3m <- T2010[top3_2010,1:12]\n# table for November, October, and December in 2017\nT2017_3m <- T2017[top3_2017,1:12]\n\n# test if they have same sample mean \nt.test(T2010_3m, T2017_3m)\n```\nFrom t-test, we get p-value = 0.3454 > 0.05, and we fail to reject the null hypothesis. At significance level of 5%, the mean of apprehensions from March to May in 2010 is equal to the mean of apprehensions from October to December in 2017. Thus, there is no significance difference betweeen maximum of apprehensions from March to May in 2010 and from October to December in 2017.\n\n\n## Time series\n\n```{r,echo=FALSE}\nts1 <- read.csv(\"/Users/mac/Desktop/MA415/assignment3/PB monthly summaries.csv\")\n#delete first column\nts2 <- ts1[2:13]\n#rearrange the columns by moving Oct, Nov, and Dec to the end \nts3 <- cbind(subset.data.frame(ts2)[,4:12],subset.data.frame(ts2)[,1:3])\n#reverse data \nts4 <- ts3[ nrow(ts3):1, ]\n#turn it to vectors \nts5 <- as.vector(t(ts4))\n#create time series \nts6 <- ts(ts5,frequency=12,start=c(2000,1))\n#plot time series\nts.plot(ts6, gpars=list(main =\"Time Series Chart of Apprehensions from 2000 to 2017\",xlab=\"year\", ylab=\"Apprehensions\", col= \"black\", lty=c(1:3)))\n#caculate annual averages\nts_avg <- apply(ts4,1,mean)\n#create annual averages in time series\nts_avg<-ts(ts_avg,start = c(2000.5), frequency=1)\n\n#create segments and text for annual averages\n#for (i in 1:18) {\n# segments(1999+i,ts_avg[i],2000+i,ts_avg[i],col = 2,lwd = 1)\n#text(2000.3 + i, ts_avg[i], labels = 1999+i, cex=0.6, col = \"red\" , font=1)\n#}\n#create points and connected dashed line for better visualization\npoints(ts_avg,col = \"blue\", pch=20)\nlines(ts_avg,col = \"blue\", pch=20,lty=6)\n#create legends\nlegend(2010,220000, legend = c(\"Monthly Apprehensions\",\"Annual Averages by points\",\"Annual Average connected by dashed line\"), \n       col = c(\"black\",\"blue\", \"blue\"),pch =c(NA,20,NA),lty=c(1,NA,3), cex=0.6)\n\n```\n\n## Conclusion\nThrough Time Series Chart of Apprehension from 2000 to 2017 above, we can observe that the decreasing trend happens long before the president Donald Trump was elected. Although we cannot deny that the new law might have some restrained effect on the drop of apprehension, the effect is limited. Then, the t-tests shows that the data through years are not significantly different. To get a better understanding of the US-Mexico border apprehensions, we need to obtain more data about the reasons that the apprehensions in each sector changes through months and years.\n\n\n",
    "created" : 1519275629720.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2366388229",
    "id" : "7D07A3CC",
    "lastKnownWriteTime" : 1519286764,
    "last_content_update" : 1519286764696,
    "path" : "~/Desktop/MA415/assignment3/Project3/assignment3.Rmd",
    "project_path" : "assignment3.Rmd",
    "properties" : {
        "source_window_id" : "wnrwbq5oyx8ms",
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}